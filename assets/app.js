angular.module("app",["ngRoute","ngAnimate"]),angular.module("app").controller("ApplicationCtrl",["$scope","$rootScope","UserSvc",function(t,e,n){window.localStorage.token&&n.getUser().then(function(e){t.$emit("userLoggedIn",e.data)}),t.$on("userLoggedIn",function(e,n){t.currentUser=n})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(t,e){t.login=function(n,o){e.login(n,o).then(function(e){t.$emit("userLoggedIn",e.data),window.location.href="#/"},function(e){t.loginValidation="Incorrect username & password combination"})},t.logout=function(){e.logout()}}]),angular.module("app").controller("PostsCtrl",["$scope","$http","PostsService",function(t,e,n){t.posts=[],t.addPost=function(){var e=CKEDITOR.instances.editor1.getData();e&&n.send({body:e,title:t.postTitle}).success(function(e){t.postBody=null,CKEDITOR.instances.editor1.setData(""),t.postTitle=null})},t.init_ckedit=function(){CKEDITOR.replace("editor1")},t.$on("ws:new_post",function(e,n){n=n[0],t.$apply(function(){t.posts.unshift(n)})}),t.$on("$viewContentLoaded",function(){}),t.currentPage=1,t.postsPerPage=2,t.prevPage=function(){t.currentPage>1&&(t.currentPage--,t.paginate())},t.nextPage=function(){t.currentPage<t.posts.length/t.postsPerPage&&(t.currentPage++,t.paginate())},t.setPage=function(e){t.currentPage=e,t.paginate()},t.range=function(t){return new Array(t)},t.paginate=function(){t.pagedPosts=[],t.pages=Math.ceil(t.posts.length/t.postsPerPage),t.numberOfPages=function(){return Math.ceil(t.posts.length/t.postsPerPage)};var e=(t.currentPage-1)*t.postsPerPage,n=e+t.postsPerPage;t.pagedPosts=t.posts.slice(e,n)},n.get().success(function(e){t.posts=e,t.paginate()})}]).filter("output_html",["$sce",function(t){return function(e){return t.trustAsHtml(e)}}]),angular.module("app").service("PostsService",["$http",function(t){this.get=function(){return t.get("/api/posts")},this.send=function(e){return t.post("/api/posts",e)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(t,e){t.register=function(n,o,r){return o!=r?void(t.validationMessage="Your passwords did not match."):void e.register(n,o)}}]),angular.module("app").config(["$routeProvider",function(t){t.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/logout",{controller:"LoginCtrl",templateUrl:"logout.html"})}]),angular.module("app").service("UserSvc",["$http",function(t){var e=this;e.getUser=function(){return t.defaults.headers.common["X-Auth"]=window.localStorage.token,t.get("/api/users").then(function(t){return t})},e.login=function(n,o){return t.post("/api/sessions",{username:n,password:o}).then(function(n){return window.localStorage.token=n.data,t.defaults.headers.common["X-Auth"]=n.data,e.getUser()})},e.register=function(n,o,r){return t.post("/api/users",{username:n,password:o}).then(function(t){return e.login(n,o).then(function(){window.location.href="/"})})},e.logout=function(){window.localStorage.removeItem("token"),window.location.href="/"}}]),angular.module("app").run(["$rootScope","$timeout","$window",function(t,e,n){!function o(){var r="ws://"+n.location.host,s=new WebSocket(r);s.onopen=function(){},s.onclose=function(t){e(o,1e4)},s.onmessage=function(e){var n=JSON.parse(e.data),o="ws:"+n.topic,r=n.data;t.$broadcast(o,r)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uQ3RybC5qcyIsImxvZ2luQ3J0bC5qcyIsInBvc3RzQ3RybC5qcyIsInBvc3RzU2VydmljZS5qcyIsInJlZ2lzdHJhdGlvbkN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyU2VydmljZS5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiVXNlclN2YyIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInRva2VuIiwiZ2V0VXNlciIsInRoZW4iLCJyZXNwb25zZSIsIiRlbWl0IiwiZGF0YSIsIiRvbiIsImV2ZW50IiwidXNlciIsImN1cnJlbnRVc2VyIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwibG9jYXRpb24iLCJocmVmIiwiZXJyb3IiLCJsb2dpblZhbGlkYXRpb24iLCJsb2dvdXQiLCIkaHR0cCIsIlBvc3RzU2VydmljZSIsInBvc3RzIiwiYWRkUG9zdCIsImNrZWRpdG9yX2NvbnRlbnQiLCJDS0VESVRPUiIsImluc3RhbmNlcyIsImVkaXRvcjEiLCJnZXREYXRhIiwic2VuZCIsImJvZHkiLCJ0aXRsZSIsInBvc3RUaXRsZSIsInN1Y2Nlc3MiLCJwb3N0IiwicG9zdEJvZHkiLCJzZXREYXRhIiwiaW5pdF9ja2VkaXQiLCJyZXBsYWNlIiwiXyIsIiRhcHBseSIsInVuc2hpZnQiLCJjdXJyZW50UGFnZSIsInBvc3RzUGVyUGFnZSIsInByZXZQYWdlIiwicGFnaW5hdGUiLCJuZXh0UGFnZSIsImxlbmd0aCIsInNldFBhZ2UiLCJwYWdlX251bWJlciIsInJhbmdlIiwibiIsIkFycmF5IiwicGFnZWRQb3N0cyIsInBhZ2VzIiwiTWF0aCIsImNlaWwiLCJudW1iZXJPZlBhZ2VzIiwiYmVnaW4iLCJlbmQiLCJzbGljZSIsImdldCIsImZpbHRlciIsIiRzY2UiLCJ2YWwiLCJ0cnVzdEFzSHRtbCIsInNlcnZpY2UiLCJ0aGlzIiwicmVnaXN0ZXIiLCJwYXNzd29yZF9jb25maXJtIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInN2YyIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInJlbW92ZUl0ZW0iLCJydW4iLCIkdGltZW91dCIsIiR3aW5kb3ciLCJjb25uZWN0IiwiaG9zdCIsImNvbm5lY3Rpb24iLCJXZWJTb2NrZXQiLCJvbm9wZW4iLCJvbmNsb3NlIiwiZSIsIm9ubWVzc2FnZSIsIm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJuYW1lIiwidG9waWMiLCIkYnJvYWRjYXN0Il0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUFBLFVBQUEsY0NEQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLFNBQUEsYUFBQSxVQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBT0FDLE9BQUFDLGFBQUFDLE9BQ0FILEVBQUFJLFVBQ0FDLEtBQUEsU0FBQUMsR0FDQVIsRUFBQVMsTUFBQSxlQUFBRCxFQUFBRSxRQUlBVixFQUFBVyxJQUFBLGVBQUEsU0FBQUMsRUFBQUMsR0FDQWIsRUFBQWMsWUFBQUQsT0NoQkFoQixRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsYUFBQSxTQUFBLFVBQUEsU0FBQUMsRUFBQUUsR0FDQUYsRUFBQWUsTUFBQSxTQUFBQyxFQUFBQyxHQUNBZixFQUFBYSxNQUFBQyxFQUFBQyxHQUNBVixLQUFBLFNBQUFDLEdBQ0FSLEVBQUFTLE1BQUEsZUFBQUQsRUFBQUUsTUFDQVAsT0FBQWUsU0FBQUMsS0FBQSxNQUVBLFNBQUFDLEdBQ0FwQixFQUFBcUIsZ0JBQUEsK0NBS0FyQixFQUFBc0IsT0FBQSxXQUNBcEIsRUFBQW9CLGFDZkF6QixRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsYUFBQSxTQUFBLFFBQUEsZUFBQSxTQUFBQyxFQUFBdUIsRUFBQUMsR0FDQXhCLEVBQUF5QixTQUNBekIsRUFBQTBCLFFBQUEsV0FDQSxHQUFB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LElBRUFWLEtBQUEsU0FBQTRELEdBR0EsTUFGQWhFLFFBQUFDLGFBQUFDLE1BQUE4RCxFQUFBekQsS0FDQWEsRUFBQXdELFNBQUFDLFFBQUFDLE9BQUEsVUFBQWQsRUFBQXpELEtBQ0FvRSxFQUFBeEUsYUFHQXdFLEVBQUFQLFNBQUEsU0FBQXZELEVBQUFDLEVBQUF1RCxHQUNBLE1BQUFqRCxHQUFBYyxLQUFBLGNBQ0FyQixTQUFBQSxFQUFBQyxTQUFBQSxJQUVBVixLQUFBLFNBQUE0RCxHQUNBLE1BQUFXLEdBQUEvRCxNQUFBQyxFQUFBQyxHQUNBVixLQUFBLFdBQ0FKLE9BQUFlLFNBQUFDLEtBQUEsU0FJQTJELEVBQUF4RCxPQUFBLFdBQ0FuQixPQUFBQyxhQUFBOEUsV0FBQSxTQUNBL0UsT0FBQWUsU0FBQUMsS0FBQSxRQ2pDQXRCLFFBQUFDLE9BQUEsT0FDQXFGLEtBQUEsYUFBQSxXQUFBLFVBQUEsU0FBQWxGLEVBQUFtRixFQUFBQyxJQUVBLFFBQUFDLEtBRUEsR0FBQUMsR0FBQSxRQUFBRixFQUFBbkUsU0FBQXFFLEtBRUFDLEVBQUEsR0FBQUMsV0FBQUYsRUFFQUMsR0FBQUUsT0FBQSxhQUtBRixFQUFBRyxRQUFBLFNBQUFDLEdBRUFSLEVBQUFFLEVBQUEsTUFHQUUsRUFBQUssVUFBQSxTQUFBRCxHQUVBLEdBQUFFLEdBQUFDLEtBQUFDLE1BQUFKLEVBQUFsRixNQUVBdUYsRUFBQSxNQUFBSCxFQUFBSSxNQUNBeEYsRUFBQW9GLEVBQUFwRixJQUdBVCxHQUFBa0csV0FBQUYsRUFBQXZGIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vVGhpcyBmaWxlIG11c3QgYmUgdGhlIGZpcnN0IGluIHRoZSBsaXN0IHRvIGJlIGNvbmNhdGVuYXRlZFxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdSb3V0ZScsICduZ0FuaW1hdGUnXSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcgLCBbXCIkc2NvcGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiVXNlclN2Y1wiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBVc2VyU3ZjKSB7XG5cdFx0Lypcblx0XHRJZiB3ZSBoYXZlIGEgc3RvcmVkIHRva2VuLCBnZXQgdGhlIHVzZXIgaW5mb3JtYXRpb24gZnJvbSBpdFxuXHRcdGFuZCBlbWl0IHRoZSB1c2VyIGxvZ2dlZGluIG1lc3NhZ2VzIGluIG9yZGVyIHRvIGFsbG93IHRoZSBVSSB0byBcblx0XHRpbmRpY2F0ZSB0byB0aGUgdXNlciB0aGF0IHRoZXkgd2VyZSBsb2dnZWQgaW5cblx0XHQqL1xuXHRcdFxuXHRcdGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuKSB7XG5cdFx0XHRVc2VyU3ZjLmdldFVzZXIoKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0XHRcdCRzY29wZS4kZW1pdCgndXNlckxvZ2dlZEluJywgcmVzcG9uc2UuZGF0YSk7XG5cdFx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0JHNjb3BlLiRvbigndXNlckxvZ2dlZEluJywgZnVuY3Rpb24oZXZlbnQsIHVzZXIpIHtcblx0XHRcdCRzY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG5cdFx0fSlcblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdMb2dpbkN0cmwnICwgW1wiJHNjb3BlXCIgLCBcIlVzZXJTdmNcIiAsIGZ1bmN0aW9uICgkc2NvcGUsIFVzZXJTdmMpIHtcblx0XHQkc2NvcGUubG9naW4gPSBmdW5jdGlvbiAodXNlcm5hbWUsIHBhc3N3b3JkKSB7XG5cdFx0XHRVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKXtcblx0XHRcdFx0XHQkc2NvcGUuJGVtaXQoJ3VzZXJMb2dnZWRJbicsIHJlc3BvbnNlLmRhdGEpO1xuXHRcdFx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJyMvJ1xuXHRcdFx0XHR9LFxuXHRcdFx0XHRmdW5jdGlvbihlcnJvcil7XG5cdFx0XHRcdCAgJHNjb3BlLmxvZ2luVmFsaWRhdGlvbiA9ICdJbmNvcnJlY3QgdXNlcm5hbWUgJiBwYXNzd29yZCBjb21iaW5hdGlvbic7XG5cdFx0XHRcdH0pXG5cblx0XHR9XG5cblx0XHQkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0VXNlclN2Yy5sb2dvdXQoKVxuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBbXCIkc2NvcGVcIiAsIFwiJGh0dHBcIiwgXCJQb3N0c1NlcnZpY2VcIiwgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFBvc3RzU2VydmljZSkge1xuXHRcdCRzY29wZS5wb3N0cyA9IFtdO1xuXHRcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIGNrZWRpdG9yX2NvbnRlbnQgPSBDS0VESVRPUi5pbnN0YW5jZXMuZWRpdG9yMS5nZXREYXRhKCk7XG5cdFx0XHRpZiAoY2tlZGl0b3JfY29udGVudCkge1xuXHRcdFx0XHRQb3N0c1NlcnZpY2Uuc2VuZCh7XG5cdFx0XHRcdFx0Ym9keTogY2tlZGl0b3JfY29udGVudCxcblx0XHRcdFx0XHR0aXRsZTogJHNjb3BlLnBvc3RUaXRsZVxuXHRcdFx0XHR9KVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHRcdC8qXG5cdFx0XHRcdFx0Ly9SZW1vdmVkIGFzIHdlYnNvY2tldCBicm9hZGNhc3Qgd291bGQgY2F1c2UgdGhlIHBvc3QgdG8gYXBwZWFyIGR1cGxpY2F0ZWQgb24gdGhlIGJyb3dzZXIgdGhhdCBpdCB3YXMgcG9zdGVkIGZyb20gXG5cdFx0XHRcdFx0Ly9hcyBib3RoIG9mIHRoZSBmdW5jdGlvbnMgd291bGQgZ2V0IGV4ZWN1dGVkIGJlY2F1c2UgdGhlIGNsaWVudCB3aG8gc2VuZHMgdGhlIHBvc3Qgd291bGQgc3RpbGwgcmVjaWV2ZSB0aGUgd2Vic29ja2V0cyBicm9hZGNhc3QgYmFjayBmcm9tIHRoZSBzZXJ2ZXIgIFxuXHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0Ly8kc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTsgXG5cdFx0XHRcdFx0JHNjb3BlLnBvc3RCb2R5ID0gbnVsbDtcblx0XHRcdFx0XHRDS0VESVRPUi5pbnN0YW5jZXMuZWRpdG9yMS5zZXREYXRhKCcnKTtcblx0XHRcdFx0XHQkc2NvcGUucG9zdFRpdGxlID0gbnVsbDtcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cblx0XHQkc2NvcGUuaW5pdF9ja2VkaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ICAgIENLRURJVE9SLnJlcGxhY2UoJ2VkaXRvcjEnKTtcblx0XHR9XG5cblx0XHQkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uKF8sIHBvc3QpIHtcblx0XHRcdHBvc3QgPSBwb3N0WzBdO1xuXHRcdFx0JHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdCRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpO1xuXHRcdFx0fSlcblx0XHR9KVxuXG5cdFx0JHNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJywgZnVuY3Rpb24oKXtcblx0XHRcdC8vdGhlIHBhZ2UgaXMgcmVhZHlcblx0XHRcdC8vYWxlcnQoXCJmb29cIik7XG5cdFx0fSk7XG5cblx0XHQkc2NvcGUuY3VycmVudFBhZ2UgPSAxO1xuXHRcdCRzY29wZS5wb3N0c1BlclBhZ2UgPSAyO1xuXG5cdFx0JHNjb3BlLnByZXZQYWdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2UgPiAxKSB7XG5cdCAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZS0tO1xuXHQgICAgICAgICAgICAkc2NvcGUucGFnaW5hdGUoKTtcblx0ICAgICAgICB9XG5cdCAgICB9O1xuICAgIFxuXHQgICAgJHNjb3BlLm5leHRQYWdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2UgPCAkc2NvcGUucG9zdHMubGVuZ3RoLyRzY29wZS5wb3N0c1BlclBhZ2UpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlKys7XG5cdCAgICAgICAgICAgICRzY29wZS5wYWdpbmF0ZSgpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cdCAgICBcblx0ICAgICRzY29wZS5zZXRQYWdlID0gZnVuY3Rpb24gKHBhZ2VfbnVtYmVyKSB7XG5cdCAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlID0gcGFnZV9udW1iZXI7XG5cdCAgICAgICAgJHNjb3BlLnBhZ2luYXRlKCk7XG5cdCAgICB9O1xuXG5cdCAgICAvL1RoaXMgd2F5IEkgY2FuIGRvOiAgXCI8bGkgbmctcmVwZWF0PVwibiBpbiByYW5nZShwYWdlcykgdHJhY2sgYnkgJGluZGV4XCI+XCIgYW5kIHNvIEkgY2FuIGRpc3BsYXkgYXMgbWFueSBpdGVtcyBhcyB0aGUgdmFsdWUgb2YgYSBudW1iZXIgYXMgdGhpcyByZXR1cm5zIGFuIGFycmF5IG9mIHRoYXQgbGVuZ2h0XG5cdCAgICAkc2NvcGUucmFuZ2UgPSBmdW5jdGlvbihuKSB7XG4gICAgICAgIFx0cmV0dXJuIG5ldyBBcnJheShuKTtcbiAgICBcdH07XG5cblx0XHQkc2NvcGUucGFnaW5hdGUgPSBmdW5jdGlvbigpIHtcblxuXHRcdFx0JHNjb3BlLnBhZ2VkUG9zdHMgPSBbXTtcblx0XHRcdCRzY29wZS5wYWdlcyA9IE1hdGguY2VpbCgkc2NvcGUucG9zdHMubGVuZ3RoLyRzY29wZS5wb3N0c1BlclBhZ2UpO1xuXG5cdFx0XHQkc2NvcGUubnVtYmVyT2ZQYWdlcyA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0cmV0dXJuIE1hdGguY2VpbCgkc2NvcGUucG9zdHMubGVuZ3RoIC8gJHNjb3BlLnBvc3RzUGVyUGFnZSk7XG5cdFx0XHR9O1xuXG5cdFx0XHR2YXIgYmVnaW4gPSAoKCRzY29wZS5jdXJyZW50UGFnZSAtMSApICogJHNjb3BlLnBvc3RzUGVyUGFnZSk7XG5cdFx0XHR2YXIgZW5kID0gYmVnaW4gKyAkc2NvcGUucG9zdHNQZXJQYWdlO1xuXG5cdFx0XHQkc2NvcGUucGFnZWRQb3N0cyA9ICRzY29wZS5wb3N0cy5zbGljZShiZWdpbiwgZW5kKTtcblx0XHR9XG5cblx0UG9zdHNTZXJ2aWNlLmdldCgpXG5cdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XG5cdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcblx0XHRcdCRzY29wZS5wYWdpbmF0ZSgpO1xuXHRcdH0pXG5cblx0fV0pXG5cblx0LmZpbHRlcignb3V0cHV0X2h0bWwnLCBbXCIkc2NlXCIsIGZ1bmN0aW9uICgkc2NlKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHZhbCk7XG5cdCAgICB9O1xuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LnNlcnZpY2UoJ1Bvc3RzU2VydmljZScsIFtcIiRodHRwXCIgLCBmdW5jdGlvbiAoJGh0dHApIHtcblx0XHR0aGlzLmdldCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnKTtcblx0XHR9XG5cdFx0dGhpcy5zZW5kID0gZnVuY3Rpb24gKHBvc3QpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzJywgcG9zdCk7XG5cdFx0fVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcgLCBbXCIkc2NvcGVcIiAsIFwiVXNlclN2Y1wiICwgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuXHRcdCRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHBhc3N3b3JkX2NvbmZpcm0pIHtcblx0XHRcdGlmIChwYXNzd29yZCAhPSBwYXNzd29yZF9jb25maXJtKSB7XG5cdFx0XHRcdCRzY29wZS52YWxpZGF0aW9uTWVzc2FnZSA9ICdZb3VyIHBhc3N3b3JkcyBkaWQgbm90IG1hdGNoLic7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb25maWcoW1wiJHJvdXRlUHJvdmlkZXJcIiAsZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG5cdFx0JHJvdXRlUHJvdmlkZXJcblx0XHRcdC53aGVuKCcvJyAsIHtjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ30pXG5cdFx0XHQud2hlbignL3JlZ2lzdGVyJyAsIHtjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ30pXG5cdFx0XHQud2hlbignL2xvZ2luJyAsIHtjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJ30pXG5cdFx0XHQud2hlbignL2xvZ291dCcgLCB7Y29udHJvbGxlcjogJ0xvZ2luQ3RybCcsIHRlbXBsYXRlVXJsOiAnbG9nb3V0Lmh0bWwnfSlcblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5zZXJ2aWNlKCdVc2VyU3ZjJywgW1wiJGh0dHBcIiwgZnVuY3Rpb24oJGh0dHApIHtcblx0XHR2YXIgc3ZjID0gdGhpcztcblx0XHRzdmMuZ2V0VXNlciA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW5cblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvdXNlcnMnKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7XG4gICAgICBcdFx0XHRyZXR1cm4gcmVzcG9uc2VcbiAgICBcdFx0fSlcblx0XHR9XG5cdFx0c3ZjLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCB7XG5cdFx0XHRcdHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0XHR9KVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHZhbCkge1xuXHRcdFx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuID0gdmFsLmRhdGE7XG5cdFx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHZhbC5kYXRhXG5cdFx0XHRcdHJldHVybiBzdmMuZ2V0VXNlcigpO1xuXHRcdFx0fSlcblx0XHR9XG5cdFx0c3ZjLnJlZ2lzdGVyID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCwgcGFzc3dvcmRfY29uZmlybSkge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvdXNlcnMnLCB7XG5cdFx0XHRcdHVzZXJuYW1lOiB1c2VybmFtZSwgcGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0XHR9KVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24gKHZhbCkge1xuXHRcdFx0XHRyZXR1cm4gc3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHRcdFx0XHQudGhlbihmdW5jdGlvbigpe1xuXHRcdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWY9ICcvJztcdFxuXHRcdFx0XHRcdH0pXG5cdFx0XHR9KVxuXHRcdH1cblx0XHRzdmMubG9nb3V0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCd0b2tlbicpO1xuXHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWY9ICcvJztcblx0XHR9XG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnJ1bihbXCIkcm9vdFNjb3BlXCIsIFwiJHRpbWVvdXRcIiAsIFwiJHdpbmRvd1wiICwgZnVuY3Rpb24gKCRyb290U2NvcGUsICR0aW1lb3V0LCAkd2luZG93KSB7XG5cdFxuXHQoZnVuY3Rpb24gY29ubmVjdCgpe1xuXHRcdC8vQ3JlYXRlIGEgd2Vic29ja2V0IGNvbm5lY3Rpb24gd2l0aCB0aGUgc2VydmVyXG5cdFx0dmFyIGhvc3QgPSBcIndzOi8vXCIgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Rcblx0XHQgIFxuXHRcdHZhciBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldChob3N0KVxuXG5cdFx0Y29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdXZWJzb2NrZXQgY29ubmVjdGVkJylcblx0XHR9XG5cblxuXHRcdGNvbm5lY3Rpb24ub25jbG9zZSA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKCdXZWJzb2NrZXQgY2xvc2VkLiBUcnlpbmcgdG8gcmVjb25uZWN0Li4uJylcblx0XHRcdCR0aW1lb3V0KGNvbm5lY3QsIDEwKjEwMDApO1xuXHRcdH0gXG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKGUpO1xuXHRcdFx0dmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cdFx0XHRcblx0XHRcdHZhciBuYW1lID0gJ3dzOicgKyBtZXNzYWdlLnRvcGljO1xuXHRcdFx0dmFyIGRhdGEgPSBtZXNzYWdlLmRhdGE7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiYnJvYWRjYXN0aW5nOiBcIik7XG5cblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdChuYW1lLCBkYXRhKTtcblx0XHR9XG5cdH0pKClcbn1dKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==