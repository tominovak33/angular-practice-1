angular.module("app",["ngRoute","ngAnimate"]),angular.module("app").controller("ApplicationCtrl",["$scope","$rootScope","UserSvc",function(e,t,n){e.baseUrl=location.host,window.localStorage.token&&n.getUser().then(function(t){e.$emit("userLoggedIn",t.data)}),e.$on("userLoggedIn",function(t,n){e.currentUser=n})}]).filter("output_html",["$sce",function(e){return function(t){return e.trustAsHtml(t)}}]).filter("startFrom",function(){return function(e,t){return e?(t=+t,e.slice(t)):[]}}),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(e,t){e.login=function(n,o){t.login(n,o).then(function(t){e.$emit("userLoggedIn",t.data),window.location.href="#/"},function(t){e.loginValidation="Incorrect username & password combination"})},e.logout=function(){t.logout()}}]),angular.module("app").controller("PostsCtrl",["$scope","$http","PostsService","filterFilter",function(e,t,n,o){e.baseUrl=location.host,e.bodyLengthLimit=250,e.posts=[],e.addPost=function(){var t=CKEDITOR.instances.editor1.getData(),o=e.urlDate(),r=e.slugify(e.postTitle),s=o+r;t&&n.send({body:t,title:e.postTitle,slug:s}).success(function(t){e.postBody=null,CKEDITOR.instances.editor1.setData(""),e.postTitle=null})},e.init_ckedit=function(){CKEDITOR.replace("editor1")},e.$on("ws:new_post",function(t,n){n=n[0],e.$apply(function(){e.posts.unshift(n),e.paginate()})}),e.$on("$viewContentLoaded",function(){}),e.currentPage=1,e.postsPerPage=5,e.prevPage=function(){e.currentPage>1&&e.currentPage--},e.nextPage=function(){e.currentPage<e.posts.length/e.postsPerPage&&e.currentPage++},e.setPage=function(t){e.currentPage=t},e.range=function(e){return new Array(e)},e.$watch("search",function(t){e.filteredPosts=o(e.posts,t),e.paginate(e.filteredPosts.length)},!0),e.paginate=function(t){e.numberOfPages=Math.ceil(t>0?t/e.postsPerPage:e.posts.length/e.postsPerPage)},e.urlDate=function(e){if(void 0===e)var t=new Date;else var t=new Date(e);var n=t.getDate(),o=t.getMonth()+1,r=t.getFullYear(),s=String(r)+"-"+String(o)+"-"+String(n)+"-";return s},e.slugify=function(e){var t=e.toLowerCase();return t=t.replace(/\s+/g,"_"),t=t.replace(/\?/g,""),t=t.replace(/\&/g,""),t=t.replace(/\=/g,"")},n.get().success(function(t){e.posts=t,e.paginate(e.posts.length)})}]),angular.module("app").service("PostsService",["$http",function(e){this.get=function(){return e.get("/api/posts")},this.send=function(t){return e.post("/api/posts",t)},this.single_slug=function(t){return e.get("/api/posts",{params:{post_slug:t.slug}})},this.single_id=function(t){return e.get("/api/posts",{params:{post_id:t.id}})},this.user_posts=function(t){return e.get("/api/posts",{params:{_author:t._author}})}}]),angular.module("app").controller("ProfileCtrl",["$scope","$http","UserSvc","PostsService","$routeParams","$route","$location",function(e,t,n,o,r,s,i){e.baseUrl=location.host;var a=r.username;e["new"]={},n.profile(a).success(function(t){e.user_profile=t,o.user_posts({_author:e.user_profile._id}).success(function(t){e.user_posts=t,e.paginate(e.user_posts.length)})}),e.checkLogin=function(){window.localStorage.token&&n.getUser().then(function(t){e.currentUser=t.data,e.user_profile._id==e.currentUser._id&&(e.pageOwner=!0)})},e.currentUser=[],e.checkLogin(),e.$on("$viewContentLoaded",function(){}),e.user_posts=[],e.currentPage=1,e.postsPerPage=5,e.prevPage=function(){e.currentPage>1&&e.currentPage--},e.nextPage=function(){e.currentPage<e.user_posts.length/e.postsPerPage&&e.currentPage++},e.setPage=function(t){e.currentPage=t},e.range=function(e){return new Array(e)},e.paginate=function(t){e.numberOfPages=Math.ceil(t>0?t/e.postsPerPage:e.user_posts.length/e.postsPerPage)},e.range=function(e){return new Array(e)},e.pageOwner,e.saveProfile=function(){var t={};for(var o in e["new"])e["new"].hasOwnProperty(o)&&""!=e["new"][o]&&(t[o]=e["new"][o]);n.profileUpdate(t).success(function(e){})}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(e,t){e.register=function(n,o,r){return o!=r?void(e.validationMessage="Your passwords did not match."):void t.register(n,o)}}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"}).when("/logout",{controller:"LoginCtrl",templateUrl:"logout.html"}).when("/post/:slug",{controller:"SinglePostCtrl",templateUrl:"singlePost.html"}).when("/post/id/:id",{controller:"SinglePostCtrl",templateUrl:"singlePost.html"}).when("/user/:username",{controller:"ProfileCtrl",templateUrl:"user.html"}).when("/user/:username/edit",{controller:"ProfileCtrl",templateUrl:"userEdit.html"})}]),angular.module("app").controller("SinglePostCtrl",["$scope","$http","PostsService","$routeParams","$route","$location",function(e,t,n,o,r,s){var i=o.slug,a=o.id;e.$on("$viewContentLoaded",function(){}),i?n.single_slug({slug:i}).success(function(t){e.post=t}):n.single_id({id:a}).success(function(t){e.post=t})}]),angular.module("app").service("UserSvc",["$http",function(e){var t=this;t.getUser=function(){return e.defaults.headers.common["X-Auth"]=window.localStorage.token,e.get("/api/users").then(function(e){return e})},t.login=function(n,o){return e.post("/api/sessions",{username:n,password:o}).then(function(n){return window.localStorage.token=n.data,e.defaults.headers.common["X-Auth"]=n.data,t.getUser()})},t.register=function(n,o,r){return e.post("/api/users",{username:n,password:o}).then(function(e){return t.login(n,o).then(function(){window.location.href="/"})})},t.logout=function(){window.localStorage.removeItem("token"),window.location.href="/"},t.profile=function(t){return e.get("/api/users/profile",{params:{username:t}})},t.profileUpdate=function(t){return e.post("/api/users/profile",t)}}]),angular.module("app").run(["$rootScope","$timeout","$window",function(e,t,n){var o=10;!function r(){o+=o;var s="ws://"+n.location.host,i=new WebSocket(s);i.onopen=function(){},i.onclose=function(e){console.log("Websocket connection closed. Attempting to recconnect in "+o+" seconds"),t(r,1e3*o)},i.onmessage=function(t){var n=JSON.parse(t.data),o="ws:"+n.topic,r=n.data;e.$broadcast(o,r)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uQ3RybC5qcyIsImxvZ2luQ3J0bC5qcyIsInBvc3RzQ3RybC5qcyIsInBvc3RzU2VydmljZS5qcyIsInByb2ZpbGVDdHJsLmpzIiwicmVnaXN0cmF0aW9uQ3RybC5qcyIsInJvdXRlcy5qcyIsInNpbmdsZVBvc3RzQ3RybC5qcyIsInVzZXJTZXJ2aWNlLmpzIiwid2Vic29ja2V0cy5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRzY29wZSIsIiRyb290U2NvcGUiLCJVc2VyU3ZjIiwiYmFzZVVybCIsImxvY2F0aW9uIiwiaG9zdCIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInRva2VuIiwiZ2V0VXNlciIsInRoZW4iLCJyZXNwb25zZSIsIiRlbWl0IiwiZGF0YSIsIiRvbiIsImV2ZW50IiwidXNlciIsImN1cnJlbnRVc2VyIiwiZmlsdGVyIiwiJHNjZSIsInZhbCIsInRydXN0QXNIdG1sIiwiaW5wdXQiLCJzdGFydCIsInNsaWNlIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiaHJlZiIsImVycm9yIiwibG9naW5WYWxpZGF0aW9uIiwibG9nb3V0IiwiJGh0dHAiLCJQb3N0c1NlcnZpY2UiLCJmaWx0ZXJGaWx0ZXIiLCJib2R5TGVuZ3RoTGltaXQiLCJwb3N0cyIsImFkZFBvc3QiLCJja2VkaXRvcl9jb250ZW50IiwiQ0tFRElUT1IiLCJpbnN0YW5jZXMiLCJlZGl0b3IxIiwiZ2V0RGF0YSIsImRhdGVfc2x1ZyIsInVybERhdGUiLCJ0aXRsZV9zbHVnIiwic2x1Z2lmeSIsInBvc3RUaXRsZSIsInNsdWciLCJzZW5kIiwiYm9keSIsInRpdGxlIiwic3VjY2VzcyIsInBvc3QiLCJwb3N0Qm9keSIsInNldERhdGEiLCJpbml0X2NrZWRpdCIsInJlcGxhY2UiLCJfIiwiJGFwcGx5IiwidW5zaGlmdCIsInBhZ2luYXRlIiwiY3VycmVudFBhZ2UiLCJwb3N0c1BlclBhZ2UiLCJwcmV2UGFnZSIsIm5leHRQYWdlIiwibGVuZ3RoIiwic2V0UGFnZSIsInBhZ2VfbnVtYmVyIiwicmFuZ2UiLCJuIiwiQXJyYXkiLCIkd2F0Y2giLCJ0ZXJtIiwiZmlsdGVyZWRQb3N0cyIsIm51bWJlcl9vZl9pdGVtcyIsIm51bWJlck9mUGFnZXMiLCJNYXRoIiwiY2VpbCIsInRpbWUiLCJ1bmRlZmluZWQiLCJkYXRlIiwiRGF0ZSIsImRheSIsImdldERhdGUiLCJtb250aCIsImdldE1vbnRoIiwieWVhciIsImdldEZ1bGxZZWFyIiwidXJsX2RhdGUiLCJTdHJpbmciLCJzdHJpbmciLCJ0b0xvd2VyQ2FzZSIsImdldCIsInNlcnZpY2UiLCJ0aGlzIiwic2luZ2xlX3NsdWciLCJwYXJhbWV0ZXJzIiwicGFyYW1zIiwicG9zdF9zbHVnIiwic2luZ2xlX2lkIiwicG9zdF9pZCIsImlkIiwidXNlcl9wb3N0cyIsIl9hdXRob3IiLCIkcm91dGVQYXJhbXMiLCIkcm91dGUiLCIkbG9jYXRpb24iLCJwcm9maWxlIiwidXNlcl9wcm9maWxlIiwiX2lkIiwiY2hlY2tMb2dpbiIsInBhZ2VPd25lciIsInNhdmVQcm9maWxlIiwicHJvZmlsZV9kZXRhaWxzIiwia2V5IiwiaGFzT3duUHJvcGVydHkiLCJwcm9maWxlVXBkYXRlIiwicmVnaXN0ZXIiLCJwYXNzd29yZF9jb25maXJtIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsInN2YyIsImRlZmF1bHRzIiwiaGVhZGVycyIsImNvbW1vbiIsInJlbW92ZUl0ZW0iLCJydW4iLCIkdGltZW91dCIsIiR3aW5kb3ciLCJyZWNvbm5lY3RfZGVsYXkiLCJjb25uZWN0IiwiY29ubmVjdGlvbiIsIldlYlNvY2tldCIsIm9ub3BlbiIsIm9uY2xvc2UiLCJlIiwiY29uc29sZSIsImxvZyIsIm9ubWVzc2FnZSIsIm1lc3NhZ2UiLCJKU09OIiwicGFyc2UiLCJuYW1lIiwidG9waWMiLCIkYnJvYWRjYXN0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QSxJQUVBLFFBQUFDLEtBRUFELEdBQUFBLENBR0EsSUFBQWhJLEdBQUEsUUFBQStILEVBQUFoSSxTQUFBQyxLQUVBa0ksRUFBQSxHQUFBQyxXQUFBbkksRUFFQWtJLEdBQUFFLE9BQUEsYUFLQUYsRUFBQUcsUUFBQSxTQUFBQyxHQUNBQyxRQUFBQyxJQUFBLDREQUFBUixFQUFBLFlBRUFGLEVBQUFHLEVBQUEsSUFBQUQsSUFHQUUsRUFBQU8sVUFBQSxTQUFBSCxHQUVBLEdBQUFJLEdBQUFDLEtBQUFDLE1BQUFOLEVBQUE5SCxNQUVBcUksRUFBQSxNQUFBSCxFQUFBSSxNQUNBdEksRUFBQWtJLEVBQUFsSSxJQUdBWixHQUFBbUosV0FBQUYsRUFBQXJJIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vVGhpcyBmaWxlIG11c3QgYmUgdGhlIGZpcnN0IGluIHRoZSBsaXN0IHRvIGJlIGNvbmNhdGVuYXRlZFxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFsnbmdSb3V0ZScsICduZ0FuaW1hdGUnXSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcgLCBbXCIkc2NvcGVcIiwgXCIkcm9vdFNjb3BlXCIsIFwiVXNlclN2Y1wiLCBmdW5jdGlvbiAoJHNjb3BlLCAkcm9vdFNjb3BlLCBVc2VyU3ZjKSB7XG5cdFx0Lypcblx0XHRJZiB3ZSBoYXZlIGEgc3RvcmVkIHRva2VuLCBnZXQgdGhlIHVzZXIgaW5mb3JtYXRpb24gZnJvbSBpdFxuXHRcdGFuZCBlbWl0IHRoZSB1c2VyIGxvZ2dlZGluIG1lc3NhZ2VzIGluIG9yZGVyIHRvIGFsbG93IHRoZSBVSSB0byBcblx0XHRpbmRpY2F0ZSB0byB0aGUgdXNlciB0aGF0IHRoZXkgd2VyZSBsb2dnZWQgaW5cblx0XHQqL1xuXHRcdCRzY29wZS5iYXNlVXJsID0gbG9jYXRpb24uaG9zdDtcblxuXHRcdFxuXHRcdGlmICh3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuKSB7XG5cdFx0XHRVc2VyU3ZjLmdldFVzZXIoKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0XHRcdCRzY29wZS4kZW1pdCgndXNlckxvZ2dlZEluJywgcmVzcG9uc2UuZGF0YSk7XG5cdFx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0JHNjb3BlLiRvbigndXNlckxvZ2dlZEluJywgZnVuY3Rpb24oZXZlbnQsIHVzZXIpIHtcblx0XHRcdCRzY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG5cdFx0fSlcblx0fV0pXG5cblx0LmZpbHRlcignb3V0cHV0X2h0bWwnLCBbXCIkc2NlXCIsIGZ1bmN0aW9uICgkc2NlKSB7XG5cdFx0cmV0dXJuIGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgICAgIHJldHVybiAkc2NlLnRydXN0QXNIdG1sKHZhbCk7XG5cdCAgICB9O1xuXHR9XSlcblxuXHQuZmlsdGVyKCdzdGFydEZyb20nLCBmdW5jdGlvbigpIHtcblx0ICAgIHJldHVybiBmdW5jdGlvbihpbnB1dCwgc3RhcnQpIHtcblx0ICAgICAgICBpZihpbnB1dCkge1xuXHQgICAgICAgICAgICBzdGFydCA9ICtzdGFydDsgLy9wYXJzZSB0byBpbnRcblx0ICAgICAgICAgICAgcmV0dXJuIGlucHV0LnNsaWNlKHN0YXJ0KTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgcmV0dXJuIFtdO1xuXHQgICAgfVxuXHR9KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcgLCBbXCIkc2NvcGVcIiAsIFwiVXNlclN2Y1wiICwgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuXHRcdCRzY29wZS5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0XHRcdFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdFx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0XHRcdCRzY29wZS4kZW1pdCgndXNlckxvZ2dlZEluJywgcmVzcG9uc2UuZGF0YSk7XG5cdFx0XHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSAnIy8nXG5cdFx0XHRcdH0sXG5cdFx0XHRcdGZ1bmN0aW9uKGVycm9yKXtcblx0XHRcdFx0ICAkc2NvcGUubG9naW5WYWxpZGF0aW9uID0gJ0luY29ycmVjdCB1c2VybmFtZSAmIHBhc3N3b3JkIGNvbWJpbmF0aW9uJztcblx0XHRcdFx0fSlcblxuXHRcdH1cblxuXHRcdCRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRVc2VyU3ZjLmxvZ291dCgpXG5cdFx0fVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIFtcIiRzY29wZVwiICwgXCIkaHR0cFwiLCBcIlBvc3RzU2VydmljZVwiLCBcImZpbHRlckZpbHRlclwiLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUG9zdHNTZXJ2aWNlLCBmaWx0ZXJGaWx0ZXIpIHtcblx0XHQkc2NvcGUuYmFzZVVybCA9IGxvY2F0aW9uLmhvc3Q7XG5cdFx0JHNjb3BlLmJvZHlMZW5ndGhMaW1pdCA9IDI1MDtcblxuXHRcdCRzY29wZS5wb3N0cyA9IFtdO1xuXHRcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0dmFyIGNrZWRpdG9yX2NvbnRlbnQgPSBDS0VESVRPUi5pbnN0YW5jZXMuZWRpdG9yMS5nZXREYXRhKCk7XG5cdFx0XHR2YXIgZGF0ZV9zbHVnID0gJHNjb3BlLnVybERhdGUoKTtcblx0XHRcdHZhciB0aXRsZV9zbHVnID0gJHNjb3BlLnNsdWdpZnkoJHNjb3BlLnBvc3RUaXRsZSk7XG5cblx0XHRcdHZhciBzbHVnID0gZGF0ZV9zbHVnICsgdGl0bGVfc2x1ZztcblxuXHRcdFx0aWYgKGNrZWRpdG9yX2NvbnRlbnQpIHtcblx0XHRcdFx0UG9zdHNTZXJ2aWNlLnNlbmQoe1xuXHRcdFx0XHRcdGJvZHk6IGNrZWRpdG9yX2NvbnRlbnQsXG5cdFx0XHRcdFx0dGl0bGU6ICRzY29wZS5wb3N0VGl0bGUsXG5cdFx0XHRcdFx0c2x1Zzogc2x1Z1xuXHRcdFx0XHR9KVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHRcdC8qXG5cdFx0XHRcdFx0Ly9SZW1vdmVkIGFzIHdlYnNvY2tldCBicm9hZGNhc3Qgd291bGQgY2F1c2UgdGhlIHBvc3QgdG8gYXBwZWFyIGR1cGxpY2F0ZWQgb24gdGhlIGJyb3dzZXIgdGhhdCBpdCB3YXMgcG9zdGVkIGZyb20gXG5cdFx0XHRcdFx0Ly9hcyBib3RoIG9mIHRoZSBmdW5jdGlvbnMgd291bGQgZ2V0IGV4ZWN1dGVkIGJlY2F1c2UgdGhlIGNsaWVudCB3aG8gc2VuZHMgdGhlIHBvc3Qgd291bGQgc3RpbGwgcmVjaWV2ZSB0aGUgd2Vic29ja2V0cyBicm9hZGNhc3QgYmFjayBmcm9tIHRoZSBzZXJ2ZXIgIFxuXHRcdFx0XHRcdCovXG5cdFx0XHRcdFx0JHNjb3BlLnBvc3RCb2R5ID0gbnVsbDtcblx0XHRcdFx0XHRDS0VESVRPUi5pbnN0YW5jZXMuZWRpdG9yMS5zZXREYXRhKCcnKTtcblx0XHRcdFx0XHQkc2NvcGUucG9zdFRpdGxlID0gbnVsbDtcblx0XHRcdFx0fSlcblx0XHRcdH1cblx0XHR9XG5cblx0XHQkc2NvcGUuaW5pdF9ja2VkaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0ICAgIENLRURJVE9SLnJlcGxhY2UoJ2VkaXRvcjEnKTtcblx0XHR9XG5cblx0XHQkc2NvcGUuJG9uKCd3czpuZXdfcG9zdCcsIGZ1bmN0aW9uKF8sIHBvc3QpIHtcblx0XHRcdHBvc3QgPSBwb3N0WzBdO1xuXHRcdFx0JHNjb3BlLiRhcHBseShmdW5jdGlvbiAoKSB7XG5cdFx0XHRcdCRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpO1xuXHRcdFx0XHQkc2NvcGUucGFnaW5hdGUoKTtcblx0XHRcdH0pXG5cdFx0fSlcblxuXHRcdCRzY29wZS4kb24oJyR2aWV3Q29udGVudExvYWRlZCcsIGZ1bmN0aW9uKCl7XG5cdFx0XHQvL3RoZSBwYWdlIGlzIHJlYWR5XG5cdFx0fSk7XG5cblx0XHQkc2NvcGUuY3VycmVudFBhZ2UgPSAxO1xuXHRcdCRzY29wZS5wb3N0c1BlclBhZ2UgPSA1O1xuXG5cdFx0JHNjb3BlLnByZXZQYWdlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2UgPiAxKSB7XG5cdCAgICAgICAgICAgICRzY29wZS5jdXJyZW50UGFnZS0tO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG4gICAgXG5cdCAgICAkc2NvcGUubmV4dFBhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZSA8ICRzY29wZS5wb3N0cy5sZW5ndGgvJHNjb3BlLnBvc3RzUGVyUGFnZSkge1xuXHQgICAgICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UrKztcblx0ICAgICAgICB9XG5cdCAgICB9O1xuXHQgICAgXG5cdCAgICAkc2NvcGUuc2V0UGFnZSA9IGZ1bmN0aW9uIChwYWdlX251bWJlcikge1xuXHQgICAgICAgICRzY29wZS5jdXJyZW50UGFnZSA9IHBhZ2VfbnVtYmVyO1xuXHQgICAgfTtcblxuXHQgICAgLy9UaGlzIHdheSBJIGNhbiBkbzogIFwiPGxpIG5nLXJlcGVhdD1cIm4gaW4gcmFuZ2UocGFnZXMpIHRyYWNrIGJ5ICRpbmRleFwiPlwiIGFuZCBzbyBJIGNhbiBkaXNwbGF5IGFzIG1hbnkgaXRlbXMgYXMgdGhlIHZhbHVlIG9mIGEgbnVtYmVyIGFzIHRoaXMgcmV0dXJucyBhbiBhcnJheSBvZiB0aGF0IGxlbmdodFxuXHQgICAgJHNjb3BlLnJhbmdlID0gZnVuY3Rpb24obikge1xuICAgICAgICBcdHJldHVybiBuZXcgQXJyYXkobik7XG4gICAgXHR9O1xuXHQgICAgXG5cdCAgICAvL3dhdGNoIHRvIHNlZSBpZiBzZWFyY2hpbmcgYW5kIHJlcGFnaW5hdGUgaWYgd2UgYXJlXG5cdCAgICAvL3RydWUgYXQgdGhlIGVuZCAgbWFnaWNhbGx5IG1ha2VzIGl0IHNvIHRoYXQgYXMgZWFjaCBleHRyYSBsZXR0ZXIgaXMgYWRkZWQgdG8gdGhlIHNlYXJjaCB3ZSBjYW4gcmVwYWdpbmF0ZVxuXHQgICAgLy93aXRob3V0IHRoZSAndHJ1ZScgaXQgb25seSBkaWQgIHRoYXRcblx0ICAgICRzY29wZS4kd2F0Y2goJ3NlYXJjaCcsIGZ1bmN0aW9uKHRlcm0pIHtcblx0ICAgICAgICAkc2NvcGUuZmlsdGVyZWRQb3N0cyA9IGZpbHRlckZpbHRlcigkc2NvcGUucG9zdHMsIHRlcm0pO1xuXHQgICAgICAgICRzY29wZS5wYWdpbmF0ZSgkc2NvcGUuZmlsdGVyZWRQb3N0cy5sZW5ndGgpO1xuXHQgICAgfSwgdHJ1ZSk7XG5cblxuXHQgICAgJHNjb3BlLnBhZ2luYXRlID0gZnVuY3Rpb24obnVtYmVyX29mX2l0ZW1zKXtcblx0ICAgIFx0aWYgKG51bWJlcl9vZl9pdGVtcyA+IDApIHtcblx0ICAgICAgICBcdCRzY29wZS5udW1iZXJPZlBhZ2VzID0gTWF0aC5jZWlsKG51bWJlcl9vZl9pdGVtcy8kc2NvcGUucG9zdHNQZXJQYWdlKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgXHQkc2NvcGUubnVtYmVyT2ZQYWdlcyA9IE1hdGguY2VpbCgkc2NvcGUucG9zdHMubGVuZ3RoLyRzY29wZS5wb3N0c1BlclBhZ2UpO1xuXHQgICAgICAgIH1cblx0ICAgIH07XG5cblx0ICAgICRzY29wZS51cmxEYXRlID0gZnVuY3Rpb24odGltZSkge1xuXHRcdFx0aWYgKHRpbWUgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHR2YXIgZGF0ZSA9IG5ldyBEYXRlKCk7XG5cdFx0XHR9XG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0dmFyIGRhdGUgPSBuZXcgRGF0ZSh0aW1lKTtcblx0XHRcdH1cblx0XHQgICAgdmFyIGRheSA9IGRhdGUuZ2V0RGF0ZSgpO1xuXHRcdCAgICB2YXIgbW9udGggPSBkYXRlLmdldE1vbnRoKCkrMTsgLy8rMSBiZWNhdXNlIG1vbnRocyBhcmUgMCBpbmRleGVkXG5cdFx0ICAgIHZhciB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xuXG5cdFx0ICAgIHZhciB1cmxfZGF0ZSA9ICBTdHJpbmcoeWVhcikgKyAnLScgKyBTdHJpbmcobW9udGgpICsgJy0nICsgU3RyaW5nKGRheSkgKyAnLScgO1xuXG5cdFx0XHRyZXR1cm4gdXJsX2RhdGU7XG5cblx0ICAgIH07XG5cblx0ICAgICRzY29wZS5zbHVnaWZ5ID0gZnVuY3Rpb24oc3RyaW5nKSB7XG5cdCAgICBcdHZhciBzbHVnID0gIHN0cmluZy50b0xvd2VyQ2FzZSgpO1xuXHQgICAgXHRzbHVnID0gc2x1Zy5yZXBsYWNlKC9cXHMrL2csXCJfXCIpO1xuXHQgICAgXHRzbHVnID0gc2x1Zy5yZXBsYWNlKC9cXD8vZywgXCJcIik7XG5cdCAgICBcdHNsdWcgPSBzbHVnLnJlcGxhY2UoL1xcJi9nLCBcIlwiKTtcblx0ICAgIFx0c2x1ZyA9IHNsdWcucmVwbGFjZSgvXFw9L2csIFwiXCIpO1xuXHQgICAgXHRyZXR1cm4gc2x1Zztcblx0ICAgIH07XG5cblx0UG9zdHNTZXJ2aWNlLmdldCgpXG5cdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3RzKSB7XG5cdFx0XHQkc2NvcGUucG9zdHMgPSBwb3N0cztcblx0XHRcdC8vY29uc29sZS5sb2cocG9zdHMpOyAvL0xvZyBhbGwgdGhlIHBvc3RzIHJlY2lldmVkIGZyb20gdGhlIHNlcnZlclxuXHRcdFx0JHNjb3BlLnBhZ2luYXRlKCRzY29wZS5wb3N0cy5sZW5ndGgpO1xuXHRcdH0pXG5cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5zZXJ2aWNlKCdQb3N0c1NlcnZpY2UnLCBbXCIkaHR0cFwiICwgZnVuY3Rpb24gKCRodHRwKSB7XG5cdFx0dGhpcy5nZXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdFx0fVxuXHRcdHRoaXMuc2VuZCA9IGZ1bmN0aW9uIChwb3N0KSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHRcdH1cblx0XHR0aGlzLnNpbmdsZV9zbHVnID0gZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCB7IHBhcmFtczoge3Bvc3Rfc2x1ZzogcGFyYW1ldGVycy5zbHVnfSB9ICk7XG5cdFx0fVxuXHRcdHRoaXMuc2luZ2xlX2lkID0gZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCB7IHBhcmFtczoge3Bvc3RfaWQ6IHBhcmFtZXRlcnMuaWR9IH0gKTtcblx0XHR9XG5cdFx0dGhpcy51c2VyX3Bvc3RzID0gZnVuY3Rpb24gKHBhcmFtZXRlcnMpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnLCB7IHBhcmFtczoge19hdXRob3I6IHBhcmFtZXRlcnMuX2F1dGhvcn0gfSApO1xuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdQcm9maWxlQ3RybCcsIFtcIiRzY29wZVwiICwgXCIkaHR0cFwiLCBcIlVzZXJTdmNcIiwgXCJQb3N0c1NlcnZpY2VcIiAsIFwiJHJvdXRlUGFyYW1zXCIsIFwiJHJvdXRlXCIsIFwiJGxvY2F0aW9uXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgVXNlclN2YywgUG9zdHNTZXJ2aWNlLCAkcm91dGVQYXJhbXMsICRyb3V0ZSwgJGxvY2F0aW9uKSB7XG5cblx0XHQkc2NvcGUuYmFzZVVybCA9IGxvY2F0aW9uLmhvc3Q7XG5cdFx0dmFyIHVzZXJuYW1lID0gJHJvdXRlUGFyYW1zLnVzZXJuYW1lO1xuXHRcdCRzY29wZS5uZXcgID0ge307XG5cblx0XHRVc2VyU3ZjLnByb2ZpbGUgKHVzZXJuYW1lKVxuXHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHVzZXJfcHJvZmlsZSkge1xuXHRcdFx0XHQkc2NvcGUudXNlcl9wcm9maWxlID0gdXNlcl9wcm9maWxlO1xuXHRcdFx0XHRQb3N0c1NlcnZpY2UudXNlcl9wb3N0cyAoe1xuXHRcdFx0XHRcdF9hdXRob3I6ICRzY29wZS51c2VyX3Byb2ZpbGUuX2lkXG5cdFx0XHRcdH0pXG5cdFx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHVzZXJfcG9zdHMpIHtcblx0XHRcdFx0XHRcdCRzY29wZS51c2VyX3Bvc3RzID0gdXNlcl9wb3N0cztcblx0XHRcdFx0XHRcdCRzY29wZS5wYWdpbmF0ZSgkc2NvcGUudXNlcl9wb3N0cy5sZW5ndGgpO1xuXHRcdFx0XHRcdH0pXG5cdFx0XHR9KVxuXG5cblx0XHQvKi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQvIENoZWNrIGN1cnJlbnRseSBsb2dnZWQgaW4gdXNlciBcblx0XHQvLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tKi9cblxuXHRcdCRzY29wZS5jaGVja0xvZ2luID0gZnVuY3Rpb24oKSB7XG5cdFx0XHQvL2lzIGFueW9uZSBsb2dnZWQgaW5cblx0XHQgIFx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4pIHtcblx0XHRcdCAgXHQvL2dldCBjdXJyZW50IHVzZXJcblx0XHRcdCAgXHRVc2VyU3ZjLmdldFVzZXIoKVxuXHRcdFx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG5cdFx0XHRcdFx0XHQkc2NvcGUuY3VycmVudFVzZXIgPSByZXNwb25zZS5kYXRhO1xuXHRcdFx0XHRcdFx0XHQvL2lzIHRoZSB1c2VyIHRoZSBzYW1lIGFzIHRoZSB1c2VyIHdobydzIHBhZ2UgdGhpcyBpc1xuXHRcdFx0XHRcdFx0XHRpZiAoJHNjb3BlLnVzZXJfcHJvZmlsZS5faWQgPT0gJHNjb3BlLmN1cnJlbnRVc2VyLl9pZCApIHtcblx0XHRcdFx0XHRcdFx0XHQkc2NvcGUucGFnZU93bmVyID0gdHJ1ZTtcblx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8gRW5kIHVzZXIgY2hlY2sgXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHQkc2NvcGUuY3VycmVudFVzZXIgPSBbXTtcblxuXHRcdCRzY29wZS5jaGVja0xvZ2luKCk7XG5cblx0XHQkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpe1xuXHRcdFx0Ly90aGUgcGFnZSBpcyByZWFkeVxuXHRcdH0pO1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBQYWdpbmF0aW9uIFxuXHRcdC8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0JHNjb3BlLnVzZXJfcG9zdHMgPSBbXTtcblxuXHRcdCRzY29wZS5jdXJyZW50UGFnZSA9IDE7XG5cdFx0JHNjb3BlLnBvc3RzUGVyUGFnZSA9IDU7XG5cblx0XHQkc2NvcGUucHJldlBhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCRzY29wZS5jdXJyZW50UGFnZSA+IDEpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlLS07XG5cdCAgICAgICAgfVxuXHQgICAgfTtcbiAgICBcblx0ICAgICRzY29wZS5uZXh0UGFnZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlIDwgJHNjb3BlLnVzZXJfcG9zdHMubGVuZ3RoLyRzY29wZS5wb3N0c1BlclBhZ2UpIHtcblx0ICAgICAgICAgICAgJHNjb3BlLmN1cnJlbnRQYWdlKys7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblx0ICAgIFxuXHQgICAgJHNjb3BlLnNldFBhZ2UgPSBmdW5jdGlvbiAocGFnZV9udW1iZXIpIHtcblx0ICAgICAgICAkc2NvcGUuY3VycmVudFBhZ2UgPSBwYWdlX251bWJlcjtcblx0ICAgIH07XG5cblx0ICAgIC8vVGhpcyB3YXkgSSBjYW4gZG86ICBcIjxsaSBuZy1yZXBlYXQ9XCJuIGluIHJhbmdlKHBhZ2VzKSB0cmFjayBieSAkaW5kZXhcIj5cIiBhbmQgc28gSSBjYW4gZGlzcGxheSBhcyBtYW55IGl0ZW1zIGFzIHRoZSB2YWx1ZSBvZiBhIG51bWJlciBhcyB0aGlzIHJldHVybnMgYW4gYXJyYXkgb2YgdGhhdCBsZW5naHRcblx0ICAgICRzY29wZS5yYW5nZSA9IGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgXHRyZXR1cm4gbmV3IEFycmF5KG4pO1xuICAgIFx0fTtcblx0ICAgIFxuXG5cdFx0JHNjb3BlLnBhZ2luYXRlID0gZnVuY3Rpb24obnVtYmVyX29mX2l0ZW1zKXtcblx0ICAgIFx0aWYgKG51bWJlcl9vZl9pdGVtcyA+IDApIHtcblx0ICAgICAgICBcdCRzY29wZS5udW1iZXJPZlBhZ2VzID0gTWF0aC5jZWlsKG51bWJlcl9vZl9pdGVtcy8kc2NvcGUucG9zdHNQZXJQYWdlKTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgZWxzZSB7XG5cdCAgICAgICAgXHQkc2NvcGUubnVtYmVyT2ZQYWdlcyA9IE1hdGguY2VpbCgkc2NvcGUudXNlcl9wb3N0cy5sZW5ndGgvJHNjb3BlLnBvc3RzUGVyUGFnZSk7XG5cdCAgICAgICAgfVxuXHQgICAgfTtcblxuXG5cblx0ICAgIC8vVGhpcyB3YXkgSSBjYW4gZG86ICBcIjxsaSBuZy1yZXBlYXQ9XCJuIGluIHJhbmdlKHBhZ2VzKSB0cmFjayBieSAkaW5kZXhcIj5cIiBhbmQgc28gSSBjYW4gZGlzcGxheSBhcyBtYW55IGl0ZW1zIGFzIHRoZSB2YWx1ZSBvZiBhIG51bWJlciBhcyB0aGlzIHJldHVybnMgYW4gYXJyYXkgb2YgdGhhdCBsZW5naHRcblx0ICAgICRzY29wZS5yYW5nZSA9IGZ1bmN0aW9uKG4pIHtcbiAgICAgICAgXHRyZXR1cm4gbmV3IEFycmF5KG4pO1xuICAgIFx0fTtcblxuXHRcdC8qLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdC8gRW5kIFBhZ2luYXRpb24gXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBQcm9maWxlIGVkaXQgb3B0aW9ucyBcblx0XHQvLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovXG5cblx0XHRpZiAoJHNjb3BlLnBhZ2VPd25lcikge1xuXG5cdFx0fVxuXG5cdFx0JHNjb3BlLnNhdmVQcm9maWxlID0gZnVuY3Rpb24gKCkge1xuXG5cdFx0XHR2YXIgcHJvZmlsZV9kZXRhaWxzID0ge307XG5cblx0XHRcdGZvciAodmFyIGtleSBpbiAkc2NvcGUubmV3KSB7XG5cdFx0XHQgIGlmICgkc2NvcGUubmV3Lmhhc093blByb3BlcnR5KGtleSkpIHtcblx0XHRcdCAgICAvL2FsZXJ0KGtleSArIFwiIC0+IFwiICsgJHNjb3BlLm5ld1trZXldKTtcblx0XHRcdCAgICBpZiAoJHNjb3BlLm5ld1trZXldICE9ICcnKSB7XG5cdFx0XHQgICAgXHRwcm9maWxlX2RldGFpbHNba2V5XSA9ICRzY29wZS5uZXdba2V5XTtcblx0XHRcdCAgICB9XG5cdFx0XHQgIH1cblx0XHRcdH1cblxuXHRcdFx0Ly9jb25zb2xlLmxvZygkc2NvcGUubmV3KTtcblx0XHRcdC8vY29uc29sZS5sb2cocHJvZmlsZV9kZXRhaWxzKTtcblxuXHRcdFx0VXNlclN2Yy5wcm9maWxlVXBkYXRlKHByb2ZpbGVfZGV0YWlscylcblx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHVzZXIpIHtcblx0XHRcdFx0XHQvL2FsZXJ0KCdkb25lJyk7XG5cdFx0XHRcdH0pXG5cdFx0fVxuXG5cdFx0LyotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0LyBFbmQgcHJvZmlsZSBlZGl0IG9wdGlvbnMgXG5cdFx0Ly0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0qL1xuXG5cdFxuXG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29udHJvbGxlcignUmVnaXN0ZXJDdHJsJyAsIFtcIiRzY29wZVwiICwgXCJVc2VyU3ZjXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG5cdFx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCwgcGFzc3dvcmRfY29uZmlybSkge1xuXHRcdFx0aWYgKHBhc3N3b3JkICE9IHBhc3N3b3JkX2NvbmZpcm0pIHtcblx0XHRcdFx0JHNjb3BlLnZhbGlkYXRpb25NZXNzYWdlID0gJ1lvdXIgcGFzc3dvcmRzIGRpZCBub3QgbWF0Y2guJztcblx0XHRcdFx0cmV0dXJuO1xuXHRcdFx0fVxuXHRcdFx0VXNlclN2Yy5yZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQpXG5cdFx0fVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbmZpZyhbXCIkcm91dGVQcm92aWRlclwiICxmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpIHtcblx0XHQkcm91dGVQcm92aWRlclxuXHRcdFx0LndoZW4oJy8nICwge2NvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCB0ZW1wbGF0ZVVybDogJ3Bvc3RzLmh0bWwnfSlcblx0XHRcdC53aGVuKCcvcmVnaXN0ZXInICwge2NvbnRyb2xsZXI6ICdSZWdpc3RlckN0cmwnLCB0ZW1wbGF0ZVVybDogJ3JlZ2lzdGVyLmh0bWwnfSlcblx0XHRcdC53aGVuKCcvbG9naW4nICwge2NvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLCB0ZW1wbGF0ZVVybDogJ2xvZ2luLmh0bWwnfSlcblx0XHRcdC53aGVuKCcvbG9nb3V0JyAsIHtjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dvdXQuaHRtbCd9KVxuXHRcdFx0LndoZW4oJy9wb3N0LzpzbHVnJyAsIHtjb250cm9sbGVyOiAnU2luZ2xlUG9zdEN0cmwnLCB0ZW1wbGF0ZVVybDogJ3NpbmdsZVBvc3QuaHRtbCd9KVxuXHRcdFx0LndoZW4oJy9wb3N0L2lkLzppZCcgLCB7Y29udHJvbGxlcjogJ1NpbmdsZVBvc3RDdHJsJywgdGVtcGxhdGVVcmw6ICdzaW5nbGVQb3N0Lmh0bWwnfSlcblx0XHRcdC53aGVuKCcvdXNlci86dXNlcm5hbWUnICwge2NvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCcsIHRlbXBsYXRlVXJsOiAndXNlci5odG1sJ30pXG5cdFx0XHQud2hlbignL3VzZXIvOnVzZXJuYW1lL2VkaXQnICwge2NvbnRyb2xsZXI6ICdQcm9maWxlQ3RybCcsIHRlbXBsYXRlVXJsOiAndXNlckVkaXQuaHRtbCd9KVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1NpbmdsZVBvc3RDdHJsJywgW1wiJHNjb3BlXCIgLCBcIiRodHRwXCIsIFwiUG9zdHNTZXJ2aWNlXCIsIFwiJHJvdXRlUGFyYW1zXCIsIFwiJHJvdXRlXCIsIFwiJGxvY2F0aW9uXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCAkaHR0cCwgUG9zdHNTZXJ2aWNlLCAkcm91dGVQYXJhbXMsICRyb3V0ZSwgJGxvY2F0aW9uKSB7XG5cblx0XHR2YXIgcG9zdF9zbHVnID0gJHJvdXRlUGFyYW1zLnNsdWc7XG5cdFx0dmFyIHBvc3RfaWQgPSAkcm91dGVQYXJhbXMuaWQ7XG5cblx0XHQkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpe1xuXHRcdFx0Ly90aGUgcGFnZSBpcyByZWFkeVxuXHRcdH0pO1xuXHRcblx0XHRpZiAocG9zdF9zbHVnKSB7XG5cdFx0XHRQb3N0c1NlcnZpY2Uuc2luZ2xlX3NsdWcoe1xuXHRcdFx0XHRzbHVnOiBwb3N0X3NsdWdcblx0XHRcdH0pXG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHQkc2NvcGUucG9zdCA9IHBvc3Q7XG5cdFx0XHR9KVxuXHRcdH1cblx0XHRlbHNlIHtcblx0XHRcdFBvc3RzU2VydmljZS5zaW5nbGVfaWQoe1xuXHRcdFx0XHRpZDogcG9zdF9pZFxuXHRcdFx0fSlcdFx0XG5cdFx0XHQuc3VjY2VzcyhmdW5jdGlvbiAocG9zdCkge1xuXHRcdFx0XHQkc2NvcGUucG9zdCA9IHBvc3Q7XG5cdFx0XHR9KVxuXHRcdH1cdFx0XHRcdFxuXG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuc2VydmljZSgnVXNlclN2YycsIFtcIiRodHRwXCIsIGZ1bmN0aW9uKCRodHRwKSB7XG5cdFx0dmFyIHN2YyA9IHRoaXM7XG5cdFx0c3ZjLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgXHRcdFx0cmV0dXJuIHJlc3BvbnNlXG4gICAgXHRcdH0pXG5cdFx0fVxuXHRcdHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuXHRcdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuXHRcdFx0fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uICh2YWwpIHtcblx0XHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS50b2tlbiA9IHZhbC5kYXRhO1xuXHRcdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB2YWwuZGF0YVxuXHRcdFx0XHRyZXR1cm4gc3ZjLmdldFVzZXIoKTtcblx0XHRcdH0pXG5cdFx0fVxuXHRcdHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHBhc3N3b3JkX2NvbmZpcm0pIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuXHRcdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuXHRcdFx0fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uICh2YWwpIHtcblx0XHRcdFx0cmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG5cdFx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmPSAnLyc7XG5cdFx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0fVxuXHRcdHN2Yy5sb2dvdXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3Rva2VuJyk7XG5cdFx0XHR3aW5kb3cubG9jYXRpb24uaHJlZj0gJy8nO1xuXHRcdH1cblx0XHRzdmMucHJvZmlsZSA9IGZ1bmN0aW9uICh1c2VybmFtZSkge1xuXHRcdFx0cmV0dXJuICRodHRwLmdldCgnL2FwaS91c2Vycy9wcm9maWxlJywgeyBwYXJhbXM6IHt1c2VybmFtZTogdXNlcm5hbWV9IH0pXG5cdFx0fVxuXHRcdHN2Yy5wcm9maWxlVXBkYXRlID0gZnVuY3Rpb24gKHByb2ZpbGUpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzL3Byb2ZpbGUnLCBwcm9maWxlIClcblx0XHR9XG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnJ1bihbXCIkcm9vdFNjb3BlXCIsIFwiJHRpbWVvdXRcIiAsIFwiJHdpbmRvd1wiICwgZnVuY3Rpb24gKCRyb290U2NvcGUsICR0aW1lb3V0LCAkd2luZG93KSB7XG5cblx0dmFyIHJlY29ubmVjdF9kZWxheSA9IDEwO1xuXHRcblx0KGZ1bmN0aW9uIGNvbm5lY3QoKXtcblx0XHQvL2luY3JlbWVudCB0aGUgcmVjb25uZWN0IGRlbGF5IHRpbWVlclxuXHRcdHJlY29ubmVjdF9kZWxheSArPSByZWNvbm5lY3RfZGVsYXk7XG5cblx0XHQvL0NyZWF0ZSBhIHdlYnNvY2tldCBjb25uZWN0aW9uIHdpdGggdGhlIHNlcnZlclxuXHRcdHZhciBob3N0ID0gXCJ3czovL1wiICsgJHdpbmRvdy5sb2NhdGlvbi5ob3N0XG5cdFx0ICBcblx0XHR2YXIgY29ubmVjdGlvbiA9IG5ldyBXZWJTb2NrZXQoaG9zdClcblxuXHRcdGNvbm5lY3Rpb24ub25vcGVuID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0Ly9jb25zb2xlLmxvZygnV2Vic29ja2V0IGNvbm5lY3RlZCcpXG5cdFx0fVxuXG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1dlYnNvY2tldCBjb25uZWN0aW9uIGNsb3NlZC4gQXR0ZW1wdGluZyB0byByZWNjb25uZWN0IGluICcgKyByZWNvbm5lY3RfZGVsYXkgKyAnIHNlY29uZHMnIClcblxuXHRcdFx0JHRpbWVvdXQoY29ubmVjdCwgcmVjb25uZWN0X2RlbGF5KjEwMDApO1xuXHRcdH0gXG5cblx0XHRjb25uZWN0aW9uLm9ubWVzc2FnZSA9IGZ1bmN0aW9uIChlKSB7XG5cdFx0XHQvL2NvbnNvbGUubG9nKGUpO1xuXHRcdFx0dmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cdFx0XHRcblx0XHRcdHZhciBuYW1lID0gJ3dzOicgKyBtZXNzYWdlLnRvcGljO1xuXHRcdFx0dmFyIGRhdGEgPSBtZXNzYWdlLmRhdGE7XG5cdFx0XHQvL2NvbnNvbGUubG9nKFwiYnJvYWRjYXN0aW5nOiBcIik7XG5cblx0XHRcdCRyb290U2NvcGUuJGJyb2FkY2FzdChuYW1lLCBkYXRhKTtcblx0XHR9XG5cdH0pKClcbn1dKSJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==