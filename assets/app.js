angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$scope","$rootScope","UserSvc",function(o,n,t){window.localStorage.token&&t.getUser().then(function(n){o.$emit("userLoggedIn",n.data)}),o.$on("userLoggedIn",function(n,t){o.currentUser=t})}]),angular.module("app").controller("LoginCtrl",["$scope","UserSvc",function(o,n){o.login=function(t,e){n.login(t,e).then(function(n){o.$emit("userLoggedIn",n.data)},function(n){o.loginValidation="Incorrect username & password combination"})}}]),angular.module("app").controller("PostsCtrl",["$scope","$http","PostsService",function(o,n,t){o.addPost=function(){o.postBody&&t.send({username:"tomi",body:CKEDITOR.instances.editor1.getData()}).success(function(n){o.postBody=null})},o.$on("ws:new_post",function(n,t){o.$apply(function(){o.posts.unshift(t)})}),o.$on("$viewContentLoaded",function(){CKEDITOR.replace("editor1")}),t.get().success(function(n){o.posts=n})}]),angular.module("app").service("PostsService",["$http",function(o){this.get=function(){return o.get("/api/posts")},this.send=function(n){return o.post("/api/posts",n)}}]),angular.module("app").controller("RegisterCtrl",["$scope","UserSvc",function(o,n){o.register=function(t,e,r){return e!=r?void(o.validationMessage="Your passwords did not match."):void n.register(t,e)}}]),angular.module("app").config(["$routeProvider",function(o){o.when("/",{controller:"PostsCtrl",templateUrl:"posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"login.html"})}]),angular.module("app").service("UserSvc",["$http",function(o){var n=this;n.getUser=function(){return o.defaults.headers.common["X-Auth"]=window.localStorage.token,o.get("/api/users").then(function(o){return o})},n.login=function(t,e){return o.post("/api/sessions",{username:t,password:e}).then(function(t){return window.localStorage.token=t.data,o.defaults.headers.common["X-Auth"]=t.data,n.getUser()})},n.register=function(t,e,r){return o.post("/api/users",{username:t,password:e}).then(function(o){return n.login(t,e).then(function(){window.location.href="/"})})},n.logout=function(){window.localStorage.removeItem("token")}}]),angular.module("app").run(["$rootScope","$timeout","$window",function(o,n,t){!function e(){var r="ws://"+t.location.host,s=new WebSocket(r);s.onopen=function(){console.log("Websocket connected")},s.onclose=function(o){console.log("Websocket closed. Trying to reconnect..."),n(e,1e4)},s.onmessage=function(n){console.log(n);var t=JSON.parse(n.data),e="ws:"+t.topic,r=t.data;console.log("broadcasting: "),o.$broadcast(e,r)}}()}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uQ3RybC5qcyIsImxvZ2luQ3J0bC5qcyIsInBvc3RzQ3RybC5qcyIsInBvc3RzU2VydmljZS5qcyIsInJlZ2lzdHJhdGlvbkN0cmwuanMiLCJyb3V0ZXMuanMiLCJ1c2VyU2VydmljZS5qcyIsIndlYnNvY2tldHMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiVXNlclN2YyIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsInRva2VuIiwiZ2V0VXNlciIsInRoZW4iLCJyZXNwb25zZSIsIiRlbWl0IiwiZGF0YSIsIiRvbiIsImV2ZW50IiwidXNlciIsImN1cnJlbnRVc2VyIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwiZXJyb3IiLCJsb2dpblZhbGlkYXRpb24iLCIkaHR0cCIsIlBvc3RzU2VydmljZSIsImFkZFBvc3QiLCJwb3N0Qm9keSIsInNlbmQiLCJib2R5IiwiQ0tFRElUT1IiLCJpbnN0YW5jZXMiLCJlZGl0b3IxIiwiZ2V0RGF0YSIsInN1Y2Nlc3MiLCJwb3N0IiwiXyIsIiRhcHBseSIsInBvc3RzIiwidW5zaGlmdCIsInJlcGxhY2UiLCJnZXQiLCJzZXJ2aWNlIiwidGhpcyIsInJlZ2lzdGVyIiwicGFzc3dvcmRfY29uZmlybSIsInZhbGlkYXRpb25NZXNzYWdlIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJzdmMiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCJ2YWwiLCJsb2NhdGlvbiIsImhyZWYiLCJsb2dvdXQiLCJyZW1vdmVJdGVtIiwicnVuIiwiJHRpbWVvdXQiLCIkd2luZG93IiwiY29ubmVjdCIsImhvc3QiLCJjb25uZWN0aW9uIiwiV2ViU29ja2V0Iiwib25vcGVuIiwiY29uc29sZSIsImxvZyIsIm9uY2xvc2UiLCJlIiwib25tZXNzYWdlIiwibWVzc2Fn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QUFBLFdBQ0FKLE9BQUFpRCxTQUFBQyxLQUFBLFNBSUFOLEVBQUFPLE9BQUEsV0FDQW5ELE9BQUFDLGFBQUFtRCxXQUFBLGFDaENBMUQsUUFBQUMsT0FBQSxPQUNBMEQsS0FBQSxhQUFBLFdBQUEsVUFBQSxTQUFBdkQsRUFBQXdELEVBQUFDLElBRUEsUUFBQUMsS0FFQSxHQUFBQyxHQUFBLFFBQUFGLEVBQUFOLFNBQUFRLEtBRUFDLEVBQUEsR0FBQUMsV0FBQUYsRUFFQUMsR0FBQUUsT0FBQSxXQUNBQyxRQUFBQyxJQUFBLHdCQUlBSixFQUFBSyxRQUFBLFNBQUFDLEdBQ0FILFFBQUFDLElBQUEsNENBQ0FSLEVBQUFFLEVBQUEsTUFHQUUsRUFBQU8sVUFBQSxTQUFBRCxHQUNBSCxRQUFBQyxJQUFBRSxFQUNBLElBQUFFLEdBQUFDLEtBQUFDLE1BQUFKLEVBQUF6RCxNQUVBOEQsRUFBQSxNQUFBSCxFQUFBSSxNQUNBL0QsRUFBQTJELEVBQUEzRCxJQUNBc0QsU0FBQUMsSUFBQSxrQkFFQWhFLEVBQUF5RSxXQUFBRixFQUFBOUQiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9UaGlzIGZpbGUgbXVzdCBiZSB0aGUgZmlyc3QgaW4gdGhlIGxpc3QgdG8gYmUgY29uY2F0ZW5hdGVkXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgWyduZ1JvdXRlJ10pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnICwgW1wiJHNjb3BlXCIsIFwiJHJvb3RTY29wZVwiLCBcIlVzZXJTdmNcIiwgZnVuY3Rpb24gKCRzY29wZSwgJHJvb3RTY29wZSwgVXNlclN2Yykge1xuXHRcdC8qXG5cdFx0SWYgd2UgaGF2ZSBhIHN0b3JlZCB0b2tlbiwgZ2V0IHRoZSB1c2VyIGluZm9ybWF0aW9uIGZyb20gaXRcblx0XHRhbmQgZW1pdCB0aGUgdXNlciBsb2dnZWRpbiBtZXNzYWdlcyBpbiBvcmRlciB0byBhbGxvdyB0aGUgVUkgdG8gXG5cdFx0aW5kaWNhdGUgdG8gdGhlIHVzZXIgdGhhdCB0aGV5IHdlcmUgbG9nZ2VkIGluXG5cdFx0Ki9cblx0XHRcblx0XHRpZiAod2luZG93LmxvY2FsU3RvcmFnZS50b2tlbikge1xuXHRcdFx0VXNlclN2Yy5nZXRVc2VyKClcblx0XHRcdFx0LnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKXtcblx0XHRcdFx0XHQkc2NvcGUuJGVtaXQoJ3VzZXJMb2dnZWRJbicsIHJlc3BvbnNlLmRhdGEpO1xuXHRcdFx0XHR9KVxuXHRcdH1cblxuXHRcdCRzY29wZS4kb24oJ3VzZXJMb2dnZWRJbicsIGZ1bmN0aW9uKGV2ZW50LCB1c2VyKSB7XG5cdFx0XHQkc2NvcGUuY3VycmVudFVzZXIgPSB1c2VyO1xuXHRcdH0pXG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuY29udHJvbGxlcignTG9naW5DdHJsJyAsIFtcIiRzY29wZVwiICwgXCJVc2VyU3ZjXCIgLCBmdW5jdGlvbiAoJHNjb3BlLCBVc2VyU3ZjKSB7XG5cdFx0JHNjb3BlLmxvZ2luID0gZnVuY3Rpb24gKHVzZXJuYW1lLCBwYXNzd29yZCkge1xuXHRcdFx0VXNlclN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG5cdFx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSl7XG5cdFx0XHRcdFx0JHNjb3BlLiRlbWl0KCd1c2VyTG9nZ2VkSW4nLCByZXNwb25zZS5kYXRhKTtcblx0XHRcdFx0fSxcblx0XHRcdFx0ZnVuY3Rpb24oZXJyb3Ipe1xuXHRcdFx0XHQgICRzY29wZS5sb2dpblZhbGlkYXRpb24gPSAnSW5jb3JyZWN0IHVzZXJuYW1lICYgcGFzc3dvcmQgY29tYmluYXRpb24nO1xuXHRcdFx0XHR9KVxuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBbXCIkc2NvcGVcIiAsIFwiJGh0dHBcIiwgXCJQb3N0c1NlcnZpY2VcIiwgZnVuY3Rpb24gKCRzY29wZSwgJGh0dHAsIFBvc3RzU2VydmljZSkge1xuXHRcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24gKCkge1xuXHRcdFx0aWYgKCRzY29wZS5wb3N0Qm9keSkge1xuXHRcdFx0XHRQb3N0c1NlcnZpY2Uuc2VuZCh7XG5cdFx0XHRcdFx0dXNlcm5hbWU6ICd0b21pJyxcblx0XHRcdFx0XHRib2R5OiBDS0VESVRPUi5pbnN0YW5jZXMuZWRpdG9yMS5nZXREYXRhKClcblx0XHRcdFx0fSlcblx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24gKHBvc3QpIHtcblx0XHRcdFx0XHQvKlxuXHRcdFx0XHRcdC8vUmVtb3ZlZCBhcyB3ZWJzb2NrZXQgYnJvYWRjYXN0IHdvdWxkIGNhdXNlIHRoZSBwb3N0IHRvIGFwcGVhciBkdXBsaWNhdGVkIG9uIHRoZSBicm93c2VyIHRoYXQgaXQgd2FzIHBvc3RlZCBmcm9tIFxuXHRcdFx0XHRcdC8vYXMgYm90aCBvZiB0aGUgZnVuY3Rpb25zIHdvdWxkIGdldCBleGVjdXRlZCBiZWNhdXNlIHRoZSBjbGllbnQgd2hvIHNlbmRzIHRoZSBwb3N0IHdvdWxkIHN0aWxsIHJlY2lldmUgdGhlIHdlYnNvY2tldHMgYnJvYWRjYXN0IGJhY2sgZnJvbSB0aGUgc2VydmVyICBcblx0XHRcdFx0XHQqL1xuXHRcdFx0XHRcdC8vJHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdCk7IFxuXHRcdFx0XHRcdCRzY29wZS5wb3N0Qm9keSA9IG51bGw7XG5cdFx0XHRcdH0pXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0JHNjb3BlLiRvbignd3M6bmV3X3Bvc3QnLCBmdW5jdGlvbihfLCBwb3N0KSB7XG5cdFx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcblx0XHRcdFx0JHNjb3BlLnBvc3RzLnVuc2hpZnQocG9zdCk7XG5cdFx0XHR9KVxuXHRcdH0pXG5cblx0XHQkc2NvcGUuJG9uKCckdmlld0NvbnRlbnRMb2FkZWQnLCBmdW5jdGlvbigpe1xuXHRcdFx0Ly90aGUgcGFnZSBpcyByZWFkeVxuICAgICAgICAgICAgQ0tFRElUT1IucmVwbGFjZSgnZWRpdG9yMScpO1xuXHRcdH0pO1xuXG5cdFBvc3RzU2VydmljZS5nZXQoKVxuXHRcdC5zdWNjZXNzKGZ1bmN0aW9uIChwb3N0cykge1xuXHRcdFx0JHNjb3BlLnBvc3RzID0gcG9zdHM7XG5cdFx0fSlcblxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LnNlcnZpY2UoJ1Bvc3RzU2VydmljZScsIFtcIiRodHRwXCIgLCBmdW5jdGlvbiAoJGh0dHApIHtcblx0XHR0aGlzLmdldCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHJldHVybiAkaHR0cC5nZXQoJy9hcGkvcG9zdHMnKTtcblx0XHR9XG5cdFx0dGhpcy5zZW5kID0gZnVuY3Rpb24gKHBvc3QpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Bvc3RzJywgcG9zdCk7XG5cdFx0fVxuXHR9XSkiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcblx0LmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcgLCBbXCIkc2NvcGVcIiAsIFwiVXNlclN2Y1wiICwgZnVuY3Rpb24gKCRzY29wZSwgVXNlclN2Yykge1xuXHRcdCRzY29wZS5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHBhc3N3b3JkX2NvbmZpcm0pIHtcblx0XHRcdGlmIChwYXNzd29yZCAhPSBwYXNzd29yZF9jb25maXJtKSB7XG5cdFx0XHRcdCRzY29wZS52YWxpZGF0aW9uTWVzc2FnZSA9ICdZb3VyIHBhc3N3b3JkcyBkaWQgbm90IG1hdGNoLic7XG5cdFx0XHRcdHJldHVybjtcblx0XHRcdH1cblx0XHRcdFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdH1cblx0fV0pIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG5cdC5jb25maWcoW1wiJHJvdXRlUHJvdmlkZXJcIiAsZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKSB7XG5cdFx0JHJvdXRlUHJvdmlkZXJcblx0XHRcdC53aGVuKCcvJyAsIHtjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgdGVtcGxhdGVVcmw6ICdwb3N0cy5odG1sJ30pXG5cdFx0XHQud2hlbignL3JlZ2lzdGVyJyAsIHtjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJywgdGVtcGxhdGVVcmw6ICdyZWdpc3Rlci5odG1sJ30pXG5cdFx0XHQud2hlbignL2xvZ2luJyAsIHtjb250cm9sbGVyOiAnTG9naW5DdHJsJywgdGVtcGxhdGVVcmw6ICdsb2dpbi5odG1sJ30pXG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuXHQuc2VydmljZSgnVXNlclN2YycsIFtcIiRodHRwXCIsIGZ1bmN0aW9uKCRodHRwKSB7XG5cdFx0dmFyIHN2YyA9IHRoaXM7XG5cdFx0c3ZjLmdldFVzZXIgPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB3aW5kb3cubG9jYWxTdG9yYWdlLnRva2VuXG5cdFx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJylcblx0XHRcdC50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkge1xuICAgICAgXHRcdFx0cmV0dXJuIHJlc3BvbnNlXG4gICAgXHRcdH0pXG5cdFx0fVxuXHRcdHN2Yy5sb2dpbiA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3Nlc3Npb25zJywge1xuXHRcdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuXHRcdFx0fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uICh2YWwpIHtcblx0XHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS50b2tlbiA9IHZhbC5kYXRhO1xuXHRcdFx0XHQkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gPSB2YWwuZGF0YVxuXHRcdFx0XHRyZXR1cm4gc3ZjLmdldFVzZXIoKTtcblx0XHRcdH0pXG5cdFx0fVxuXHRcdHN2Yy5yZWdpc3RlciA9IGZ1bmN0aW9uICh1c2VybmFtZSwgcGFzc3dvcmQsIHBhc3N3b3JkX2NvbmZpcm0pIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywge1xuXHRcdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIHBhc3N3b3JkOiBwYXNzd29yZFxuXHRcdFx0fSlcblx0XHRcdC50aGVuKGZ1bmN0aW9uICh2YWwpIHtcblx0XHRcdFx0cmV0dXJuIHN2Yy5sb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpXG5cdFx0XHRcdFx0LnRoZW4oZnVuY3Rpb24oKXtcblx0XHRcdFx0XHRcdHdpbmRvdy5sb2NhdGlvbi5ocmVmPSAnLyc7XHRcblx0XHRcdFx0XHR9KVxuXHRcdFx0fSlcblx0XHR9XG5cdFx0c3ZjLmxvZ291dCA9IGZ1bmN0aW9uICgpIHtcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndG9rZW4nKTtcblx0XHR9XG5cdH1dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnJ1bihbXCIkcm9vdFNjb3BlXCIsIFwiJHRpbWVvdXRcIiAsIFwiJHdpbmRvd1wiICwgZnVuY3Rpb24gKCRyb290U2NvcGUsICR0aW1lb3V0LCAkd2luZG93KSB7XG5cdFxuXHQoZnVuY3Rpb24gY29ubmVjdCgpe1xuXHRcdC8vQ3JlYXRlIGEgd2Vic29ja2V0IGNvbm5lY3Rpb24gd2l0aCB0aGUgc2VydmVyXG5cdFx0dmFyIGhvc3QgPSBcIndzOi8vXCIgKyAkd2luZG93LmxvY2F0aW9uLmhvc3Rcblx0XHQgIFxuXHRcdHZhciBjb25uZWN0aW9uID0gbmV3IFdlYlNvY2tldChob3N0KVxuXG5cdFx0Y29ubmVjdGlvbi5vbm9wZW4gPSBmdW5jdGlvbiAoKSB7XG5cdFx0XHRjb25zb2xlLmxvZygnV2Vic29ja2V0IGNvbm5lY3RlZCcpXG5cdFx0fVxuXG5cblx0XHRjb25uZWN0aW9uLm9uY2xvc2UgPSBmdW5jdGlvbiAoZSkge1xuXHRcdFx0Y29uc29sZS5sb2coJ1dlYnNvY2tldCBjbG9zZWQuIFRyeWluZyB0byByZWNvbm5lY3QuLi4nKVxuXHRcdFx0JHRpbWVvdXQoY29ubmVjdCwgMTAqMTAwMCk7XG5cdFx0fSBcblxuXHRcdGNvbm5lY3Rpb24ub25tZXNzYWdlID0gZnVuY3Rpb24gKGUpIHtcblx0XHRcdGNvbnNvbGUubG9nKGUpO1xuXHRcdFx0dmFyIG1lc3NhZ2UgPSBKU09OLnBhcnNlKGUuZGF0YSk7XG5cdFx0XHRcblx0XHRcdHZhciBuYW1lID0gJ3dzOicgKyBtZXNzYWdlLnRvcGljO1xuXHRcdFx0dmFyIGRhdGEgPSBtZXNzYWdlLmRhdGE7XG5cdFx0XHRjb25zb2xlLmxvZyhcImJyb2FkY2FzdGluZzogXCIpO1xuXG5cdFx0XHQkcm9vdFNjb3BlLiRicm9hZGNhc3QobmFtZSwgZGF0YSk7XG5cdFx0fVxuXHR9KSgpXG59XSkiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=